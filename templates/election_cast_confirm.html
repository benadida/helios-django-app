{% extends TEMPLATE_BASE %}
{% block title %}Confirm Vote{% endblock %}

{% block content %}
<script language="javascript">
$(document).ready(function() {
  $('#waiting_div').hide();
});

function show_waiting() {
  $('#cast_form').hide();
  $('#waiting_div').show();
}
</script>
<h1>Confirm your Vote</h1>

<h3>Your Ballot</h3>

<p style="font-size:1.6em;">
    <tt>{{vote_fingerprint}}</tt>
</p>

<h3>Your Identity</h3>
{% if user %}
<p style="font-size: 1.4em;">
    {{user.user_id}} [{{user.user_type}}]<br />
    (<a href="{% url auth.views.logout %}?return_url={{CURRENT_URL}}">logout</a>)
</p>

{% if voter %}
{% if past_votes %}
<h3>Past Votes Cast for this Election</h3>
<ul>
{% for vote in past_votes %}
<li> <tt>{{vote.vote_hash}}</tt></li>
{% endfor %}
</ul>
{% else %}
<em>no vote cast yet</em>
{% endif %}
<br /><br />
<div id="cast_form">
<form method="post" action="" onsubmit="show_waiting()">
    <input type="hidden" name="csrf_token" value="{{csrf_token}}" />
    
    <input type="submit" value="cast this ballot" />
</form>
</div>
<div id="waiting_div">
    Verifying and Casting your ballot<br />
    <img src="/static/helios/loading.gif" />
</div>
{% else %}
<b>You are <em>not</em> registered for this election.</b><br />
{% endif %}

{% else %}
Before you can cast this ballot, you'll need to <a href="{% url auth.views.index %}?return_url={% url helios.views.one_election_cast_confirm election.uuid %}">log in</a>.<br />
Don't worry, you can go log in without losing your ballot.
{% endif %}
{% endblock %}
